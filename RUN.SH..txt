#!/bin/bash

# --- Passo 1: Instalar as dependências ---
# Em vez de fazer isso no "Build Command", fazemos aqui para garantir
# que tudo aconteça no mesmo ambiente.
echo "--- Instalando dependências ---"
pip install -r requirements.txt

# --- Passo 2: Aplicar as migrações do banco de dados ---
echo "--- Aplicando migrações do banco de dados ---"
python -m alembic upgrade head

# --- Passo 3: Iniciar o servidor da API ---
echo "--- Iniciando o servidor ---"
python -m uvicorn main:app --host 0.0.0.0 --port $PORT
